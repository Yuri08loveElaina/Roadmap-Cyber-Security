<?php
$conn = new mysqli("localhost", "root", "", "lab");

if (isset($_GET['id'])) {
    $id = $_GET['id'];
    $start = microtime(true);

    $sql = "SELECT * FROM users WHERE id=$id";
    $res = $conn->query($sql);

    // Mô phỏng delay nếu id = 1 để làm Time-based Blind SQLi
    if ($id == "1' AND IF(1=1, SLEEP(5), 0)-- ") {
        sleep(5);
    }

    $end = microtime(true);
    $diff = $end - $start;

    echo "Query took $diff seconds<br>";

    if ($res && $res->num_rows > 0) {
        echo "User found";
    } else {
        echo "No user";
    }
}
?>
<form>
    <input name="id" placeholder="Enter user id">
    <button>Check</button>
</form>
